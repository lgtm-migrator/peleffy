

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>peleffy.topology.Molecule &mdash; Open Force Field for PELE  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="peleffy.topology.Topology" href="peleffy.topology.Topology.html" />
    <link rel="prev" title="Topology representations" href="../../topology.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> Open Force Field for PELE
          

          
          </a>

          
            
            
              <div class="version">
                0+untagged.1.gc3874d4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releasehistory.html">Release History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage.html">Generate PELE parameter files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples.html">Examples</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../topology.html">Topology representations</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../topology.html#primary-objects">Primary objects</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">peleffy.topology.Molecule</a></li>
<li class="toctree-l3"><a class="reference internal" href="peleffy.topology.Topology.html">peleffy.topology.Topology</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../topology.html#secondary-objects">Secondary objects</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../forcefield.html">Forcefield methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../template.html">Template handlers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../solvent.html">Solvent models</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Open Force Field for PELE</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../topology.html">Topology representations</a> &raquo;</li>
        
      <li>peleffy.topology.Molecule</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/api/autogenerated/peleffy.topology.Molecule.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="peleffy-topology-molecule">
<h1>peleffy.topology.Molecule<a class="headerlink" href="#peleffy-topology-molecule" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="peleffy.topology.Molecule">
<em class="property">class </em><code class="sig-prename descclassname">peleffy.topology.</code><code class="sig-name descname">Molecule</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">smiles</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pdb_block</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rotamer_resolution</span><span class="o">=</span><span class="default_value">30</span></em>, <em class="sig-param"><span class="n">exclude_terminal_rotamers</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">tag</span><span class="o">=</span><span class="default_value">'UNK'</span></em>, <em class="sig-param"><span class="n">connectivity_template</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">core_constraints</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">allow_undefined_stereo</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">hydrogens_are_explicit</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">fix_pdb</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/peleffy/topology/molecule.html#Molecule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#peleffy.topology.Molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>It represent wraps up all the tools to parameterize a molecule with
the OpenForceField toolkit for PELE.</p>
<blockquote>
<div><dl class="py method">
<dt id="peleffy.topology.Molecule.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">smiles</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pdb_block</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rotamer_resolution</span><span class="o">=</span><span class="default_value">30</span></em>, <em class="sig-param"><span class="n">exclude_terminal_rotamers</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">tag</span><span class="o">=</span><span class="default_value">'UNK'</span></em>, <em class="sig-param"><span class="n">connectivity_template</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">core_constraints</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">allow_undefined_stereo</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">hydrogens_are_explicit</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">fix_pdb</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/peleffy/topology/molecule.html#Molecule.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#peleffy.topology.Molecule.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>It initializes a Molecule object through a PDB file or a SMILES
tag.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em>) – The path to a PDB with the molecule structure</p></li>
<li><p><strong>smiles</strong> (<em>str</em>) – The smiles tag</p></li>
<li><p><strong>rotamer_resolution</strong> (<em>float</em>) – The resolution in degrees to discretize the rotamer’s
conformational space. Default is 30</p></li>
<li><p><strong>exclude_terminal_rotamers</strong> (<em>bool</em>) – Whether to exclude terminal rotamers when generating the
rotamers library  or not</p></li>
<li><p><strong>name</strong> (<em>str</em>) – The molecule name</p></li>
<li><p><strong>tag</strong> (<em>str</em>) – The molecule tag. It must be a 3-character string</p></li>
<li><p><strong>connectivity_template</strong> (<em>an rdkit.Chem.rdchem.Mol object</em>) – A molecule represented with RDKit to use when assigning the
connectivity of this Molecule object</p></li>
<li><p><strong>core_constraints</strong> (<em>list[int or str]</em>) – It defines the list of atoms to constrain in the core, thus,
the core will be forced to contain them. Atoms can be specified
through integers that match the atom index or strings that
match with the atom PDB name</p></li>
<li><p><strong>allow_undefined_stereo</strong> (<em>bool</em>) – Whether to allow a molecule with undefined stereochemistry
to be defined or try to assign the stereochemistry and
raise a complaint if not possible. Default is False</p></li>
<li><p><strong>hydrogens_are_explicit</strong> (<em>bool</em>) – Whether the input molecule has explicit information about
hydrogen atoms or not. Otherwise, they will be added when
the molecule is built. Default is True</p></li>
<li><p><strong>fix_pdb</strong> (<em>bool</em>) – Activates or deactivate the PDB fixer that is executed
prior parsing it</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Load a molecule from a PDB file and parameterize it with Open
Force Field</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">peleffy.topology</span> <span class="kn">import</span> <span class="n">Molecule</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="s1">&#39;molecule.pdb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">parameterize</span><span class="p">(</span><span class="s1">&#39;openff_unconstrained-1.2.0.offxml&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Load a molecule using a SMILES tag and parameterize it with Open
Force Field</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">peleffy.topology</span> <span class="kn">import</span> <span class="n">Molecule</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">smiles</span><span class="o">=</span><span class="s1">&#39;Cc1ccccc1&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Load a molecule usign a PDB file (without connectivity) and assign
the missing connectivity from an RDKit template (e.g. obtained
from qcportal and the Open Force Field Toolkit)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">qcportal</span> <span class="k">as</span> <span class="nn">ptl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openff.toolkit.topology</span> <span class="kn">import</span> <span class="n">Molecule</span> <span class="k">as</span> <span class="n">OFFMolecule</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_collection</span><span class="p">(</span><span class="s1">&#39;OptimizationDataset&#39;</span><span class="p">,</span>
<span class="go">                               &#39;Kinase Inhibitors: WBO Distributions&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">entry</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">get_entry</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol_record</span> <span class="o">=</span> <span class="n">OFFMolecule</span><span class="o">.</span><span class="n">from_qcschema</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">template</span> <span class="o">=</span> <span class="n">mol_record</span><span class="o">.</span><span class="n">to_rdkit</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">peleffy.topology</span> <span class="kn">import</span> <span class="n">Molecule</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="s1">&#39;PDB_without_connectivity.pdb&#39;</span><span class="p">,</span>
<span class="go">                        template=template)</span>
</pre></div>
</div>
<p>Load a molecule and create its rotamer library template with
a core constraint</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">peleffy.topology</span> <span class="kn">import</span> <span class="n">Molecule</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">peleffy.topology</span> <span class="kn">import</span> <span class="n">RotamerLibrary</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">smiles</span><span class="o">=</span><span class="s1">&#39;CCCC&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;butane&#39;</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s1">&#39;BUT&#39;</span><span class="p">,</span>
<span class="go">                        exclude_terminal_rotamers=False,</span>
<span class="go">                        core_constraints=[0, ])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rotamer_library</span> <span class="o">=</span> <span class="n">RotamerLibrary</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rotamer_library</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s1">&#39;butz&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Deactivate OpenFF Toolkit’s stereochemistry checking when
loading a molecule</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">peleffy.topology</span> <span class="kn">import</span> <span class="n">Molecule</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="s1">&#39;molecule_with_undefined_stereochemistry.pdb&#39;</span><span class="p">,</span>
<span class="go">                        allow_undefined_stereo=True)</span>
</pre></div>
</div>
<p>Load a molecule with no explicit hydrogen atoms and ask the builder
to add them</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">peleffy.topology</span> <span class="kn">import</span> <span class="n">Molecule</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="s1">&#39;molecule_with_implicit_hydrogen.pdb&#39;</span><span class="p">,</span>
<span class="go">                        hydrogens_are_explicit=False)</span>
</pre></div>
</div>
<p>Display the molecular representation in a Jupyter Notebook</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">peleffy.topology</span> <span class="kn">import</span> <span class="n">Molecule</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">smiles</span><span class="o">=</span><span class="s1">&#39;CCCC&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;butane&#39;</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s1">&#39;BUT&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">display</span><span class="p">(</span><span class="n">molecule</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="peleffy.topology.Molecule.from_openff">
<em class="property">static </em><code class="sig-name descname">from_openff</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">openff_molecule</span></em>, <em class="sig-param"><span class="n">rotamer_resolution</span><span class="o">=</span><span class="default_value">30</span></em>, <em class="sig-param"><span class="n">exclude_terminal_rotamers</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">tag</span><span class="o">=</span><span class="default_value">'UNK'</span></em>, <em class="sig-param"><span class="n">connectivity_template</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">core_constraints</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">allow_undefined_stereo</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">hydrogens_are_explicit</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/peleffy/topology/molecule.html#Molecule.from_openff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#peleffy.topology.Molecule.from_openff" title="Permalink to this definition">¶</a></dt>
<dd><p>It initializes and returns a peleffy Molecule representation
from an OpenForceField molecular representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>openff_molecule</strong> (<em>an openforcefield.topology.Molecule object</em>) – The OpenForceField’s Molecule to use to initialize a peleffy
Molecule object</p></li>
<li><p><strong>rotamer_resolution</strong> (<em>float</em>) – The resolution in degrees to discretize the rotamer’s
conformational space. Default is 30</p></li>
<li><p><strong>exclude_terminal_rotamers</strong> (<em>bool</em>) – Whether to exclude terminal rotamers when generating the
rotamers library  or not</p></li>
<li><p><strong>name</strong> (<em>str</em>) – The molecule name</p></li>
<li><p><strong>tag</strong> (<em>str</em>) – The molecule tag. It must be a 3-character string</p></li>
<li><p><strong>connectivity_template</strong> (<em>an rdkit.Chem.rdchem.Mol object</em>) – A molecule represented with RDKit to use when assigning the
connectivity of this Molecule object</p></li>
<li><p><strong>core_constraints</strong> (<em>list[int or str]</em>) – It defines the list of atoms to constrain in the core, thus,
the core will be forced to contain them. Atoms can be specified
through integers that match the atom index or strings that
match with the atom PDB name</p></li>
<li><p><strong>allow_undefined_stereo</strong> (<em>bool</em>) – Whether to allow a molecule with undefined stereochemistry
to be defined or try to assign the stereochemistry and
raise a complaint if not possible. Default is False</p></li>
<li><p><strong>hydrogens_are_explicit</strong> (<em>bool</em>) – Whether the input molecule has explicit information about
hydrogen atoms or not. Otherwise, they will be added when
the molecule is built. Default is True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>molecule</strong> – The resulting peleffy’s Molecule object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>an peleffy.topology.Molecule</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Load a molecule from an RDKit molecular representation</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">rdkit</span> <span class="kn">import</span> <span class="n">Chem</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdkit_molecule</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromPDBFile</span><span class="p">(</span><span class="n">pdb_path</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">peleffy.topology</span> <span class="kn">import</span> <span class="n">Molecule</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_rdkit</span><span class="p">(</span><span class="n">rdkit_molecule</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="peleffy.topology.Molecule.from_rdkit">
<em class="property">static </em><code class="sig-name descname">from_rdkit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rdkit_molecule</span></em>, <em class="sig-param"><span class="n">rotamer_resolution</span><span class="o">=</span><span class="default_value">30</span></em>, <em class="sig-param"><span class="n">exclude_terminal_rotamers</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">tag</span><span class="o">=</span><span class="default_value">'UNK'</span></em>, <em class="sig-param"><span class="n">connectivity_template</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">core_constraints</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">allow_undefined_stereo</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">hydrogens_are_explicit</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/peleffy/topology/molecule.html#Molecule.from_rdkit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#peleffy.topology.Molecule.from_rdkit" title="Permalink to this definition">¶</a></dt>
<dd><p>It initializes and returns a peleffy Molecule representation
from an RDKit molecular representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rdkit_molecule</strong> (<em>an rdkit.Chem.rdchem.Mol object</em>) – The RDKit’s Molecule object to use to initialize a peleffy
Molecule object</p></li>
<li><p><strong>rotamer_resolution</strong> (<em>float</em>) – The resolution in degrees to discretize the rotamer’s
conformational space. Default is 30</p></li>
<li><p><strong>exclude_terminal_rotamers</strong> (<em>bool</em>) – Whether to exclude terminal rotamers when generating the
rotamers library  or not</p></li>
<li><p><strong>name</strong> (<em>str</em>) – The molecule name</p></li>
<li><p><strong>tag</strong> (<em>str</em>) – The molecule tag. It must be a 3-character string</p></li>
<li><p><strong>connectivity_template</strong> (<em>an rdkit.Chem.rdchem.Mol object</em>) – A molecule represented with RDKit to use when assigning the
connectivity of this Molecule object</p></li>
<li><p><strong>core_constraints</strong> (<em>list[int or str]</em>) – It defines the list of atoms to constrain in the core, thus,
the core will be forced to contain them. Atoms can be specified
through integers that match the atom index or strings that
match with the atom PDB name</p></li>
<li><p><strong>allow_undefined_stereo</strong> (<em>bool</em>) – Whether to allow a molecule with undefined stereochemistry
to be defined or try to assign the stereochemistry and
raise a complaint if not possible. Default is False</p></li>
<li><p><strong>hydrogens_are_explicit</strong> (<em>bool</em>) – Whether the input molecule has explicit information about
hydrogen atoms or not. Otherwise, they will be added when
the molecule is built. Default is True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>molecule</strong> – The resulting peleffy’s Molecule object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>an peleffy.topology.Molecule</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Load a molecule from an RDKit molecular representation</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">rdkit</span> <span class="kn">import</span> <span class="n">Chem</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdkit_molecule</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromPDBFile</span><span class="p">(</span><span class="n">pdb_path</span><span class="p">,</span> <span class="n">removeHs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">peleffy.topology</span> <span class="kn">import</span> <span class="n">Molecule</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="o">.</span><span class="n">from_rdkit</span><span class="p">(</span><span class="n">rdkit_molecule</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="peleffy.topology.Molecule.get_conformer">
<code class="sig-name descname">get_conformer</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/peleffy/topology/molecule.html#Molecule.get_conformer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#peleffy.topology.Molecule.get_conformer" title="Permalink to this definition">¶</a></dt>
<dd><p>It gets the current conformer of the molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>conformer</strong> – The array of 3D coordinates of all the atoms in the molecule</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="peleffy.topology.Molecule.get_pdb_atom_names">
<code class="sig-name descname">get_pdb_atom_names</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/peleffy/topology/molecule.html#Molecule.get_pdb_atom_names"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#peleffy.topology.Molecule.get_pdb_atom_names" title="Permalink to this definition">¶</a></dt>
<dd><p>It returns the PDB atom names of all the atoms in the molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>pdb_atom_names</strong> – The PDB atom names of all the atoms in this Molecule object</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="peleffy.topology.Molecule.set_conformer">
<code class="sig-name descname">set_conformer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">conformer</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/peleffy/topology/molecule.html#Molecule.set_conformer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#peleffy.topology.Molecule.set_conformer" title="Permalink to this definition">¶</a></dt>
<dd><p>It sets a new conformer to the molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>conformer</strong> (<em>an RDKit.Chem.rdchem.Conformer object</em>) – The conformer to set to the molecule</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="peleffy.topology.Molecule.set_name">
<code class="sig-name descname">set_name</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/peleffy/topology/molecule.html#Molecule.set_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#peleffy.topology.Molecule.set_name" title="Permalink to this definition">¶</a></dt>
<dd><p>It sets the name of the molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – The name to set to the molecule</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="peleffy.topology.Molecule.set_tag">
<code class="sig-name descname">set_tag</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tag</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/peleffy/topology/molecule.html#Molecule.set_tag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#peleffy.topology.Molecule.set_tag" title="Permalink to this definition">¶</a></dt>
<dd><p>It sets the tag of the molecule. It must be a 3-character string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tag</strong> (<em>str</em>) – The tag to set to the molecule. It must be a 3-character string</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="peleffy.topology.Molecule.to_pdb_file">
<code class="sig-name descname">to_pdb_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/peleffy/topology/molecule.html#Molecule.to_pdb_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#peleffy.topology.Molecule.to_pdb_file" title="Permalink to this definition">¶</a></dt>
<dd><p>It writes the molecule to a PDB file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – Path to write to</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
<p class="rubric">Attributes</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">allow_undefined_stereo</span></code></p></td>
<td><p>Whether to allow a molecule with undefined stereochemistry to be defined or try to assign the stereochemistry and raise a complaint if not possible</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">connectivity_template</span></code></p></td>
<td><p>The template containing the correct connectivity for this Molecule object.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">core_constraints</span></code></p></td>
<td><p>The list of indices or PDB names of the atoms to constraint to the core when building the rotamers.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">exclude_terminal_rotamers</span></code></p></td>
<td><p>The behavior when handling terminal rotamers when generating the rotamers library.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">fix_pdb</span></code></p></td>
<td><p>It activates or deactivates the PDB fixer prior parsing the PDB file.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">graph</span></code></p></td>
<td><p>The topological graph of the molecule.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">hydrogens_are_explicit</span></code></p></td>
<td><p>Whether the input molecule has explicit information about hydrogen atoms or not.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">name</span></code></p></td>
<td><p>Molecule’s name.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">off_molecule</span></code></p></td>
<td><p>The OpenForceField’s molecule instance linked to the molecule.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">rdkit_molecule</span></code></p></td>
<td><p>The RDKit’s molecule instance linked to the molecule.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">rotamer_resolution</span></code></p></td>
<td><p>The resolution to be used when generating the rotamers library.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">rotamers</span></code></p></td>
<td><p>The list of rotamers of the molecule.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">tag</span></code></p></td>
<td><p>Molecule’s tag.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="peleffy.topology.Topology.html" class="btn btn-neutral float-right" title="peleffy.topology.Topology" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../../topology.html" class="btn btn-neutral float-left" title="Topology representations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Barcelona Supercomputing Center

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>